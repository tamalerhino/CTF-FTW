# Spawning/Upgrading a TTY Shell from a simple shell

Different ways to spawn a tty shell once you get in and you get an error sying its not a tty shell.

## Python
```
python -c 'import pty; pty.spawn("/bin/bash")'
```
## Basic tools
```
echo os.system('/bin/bash')
```
```
/bin/sh -i
```
(From within vi)
```
:!bash
```
```
:set shell=/bin/bash:shell
```
(From within nmap)
```
!sh
```
## Perl
```
perl —e 'exec "/bin/sh";'
```
```
perl: exec "/bin/sh";
```
## Ruby
```
ruby: exec "/bin/sh"
```
(From within IRB)
```
exec "/bin/sh"
```
## Lua
```
lua: os.execute('/bin/sh')
```
Many of these will also allow you to escape jail shells. The top 3 would be my most successful in general for spawning from the command line.

## Good ol NC
#### TLDR
```
# In reverse shell
$ python -c 'import pty; pty.spawn("/bin/bash")'
Ctrl-Z

# In Kali
$ stty raw -echo
$ fg

# In reverse shell
$ reset
$ export SHELL=bash
$ export TERM=xterm-256color
$ stty rows <num> columns <cols>
```



1. use python to spawn a pty shell
```
python -c 'import pty; pty.spawn("/bin/sh")'
```
2. Once bash is running in the PTY, background the shell with `Ctrl-Z`
3. While the shell is in the background, now examine the current terminal and STTY info so we can force the connected shell to match it:
```
root@kali:~# echo $TERM
xterm-256color
```
```
root@kali:~# stty -a
speed 38400 baud; rows 32; columns 73; line = 0;
....
```
The info you need is the term type, the rows and colums.
4. With the Shell still backgrounded set the current stty to type raw and tell it to `echo` the input cahraacters.
```
stty raw -echo
```
5. With a raw stty, input/output will look weird and you won’t see the next commands, but as you type they are being processed. next type `fg` it wwill repoen the revese sehll but formating will be off, just type `reset`
6. After the reset it will look  normal, last step is to se the shell term type and size to match.
```
$ export SHELL=bash
$ export TERM=xterm256-color
$ stty rows 38 columns 116
```
